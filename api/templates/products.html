{% extends 'base.html' %}
{% load static %}

{% block title %}Products - NokshiBox{% endblock %}

{% block nav_items %}
<li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Home</a></li>
<li class="nav-item"><a class="nav-link" href="{% url 'products' %}">Products</a></li>
<li class="nav-item"><a class="nav-link" href="{% url 'about' %}">About Us</a></li>
<li class="nav-item"><a class="nav-link" href="#">Contact Us</a></li>
{% endblock %}

{% block content %}
<div class="min-h-screen py-12 px-4 bg-cover bg-center" style="background-image: url('{% static 'image/background.jpg' %}');">

  <div class="max-w-6xl mx-auto flex flex-col md:flex-row ml-4 gap-6">

    <!-- Sidebar: Categories -->
    <div class="md:w-1/4 flex flex-col items-center bg-white/60 backdrop-blur-sm rounded-3xl p-6 border-4 border-[#d9b08c] shadow-lg animate-fadeIn">

      <!-- Logo -->
      <div class="w-44 h-28 mb-3">
        <img src="{% static 'image/pr.png' %}" alt="Logo" class="w-full h-full object-cover rounded-lg shadow-md">
      </div>

      <!-- Categories -->
      <h5 class="text-[#3b2f2f] font-bold text-xl mb-6 relative after:absolute after:left-1/2 after:-bottom-1 after:w-40 after:h-1 after:bg-[#d9b08c] after:-translate-x-1/2">
        Categories
      </h5>

      <ul class="flex flex-col items-center justify-center space-y-4 text-[#3b2f2f] font-semibold text-lg" id="category-list">
        <li class="cursor-pointer relative group px-4 py-2 rounded hover:bg-[#d9b08c] hover:text-white transition" data-category="all">
          <span class="relative z-10">All</span>
          <span class="absolute bottom-0 left-1/2 w-0 h-1 bg-[#d9b08c] transition-all group-hover:w-full group-hover:-translate-x-1/2"></span>
        </li>
        {% for category in categories %}
        <li class="cursor-pointer relative group px-4 py-2 rounded hover:bg-[#d9b08c] hover:text-white transition" data-category="{{ category.id }}">
          <span class="relative z-10">{{ category.name }}</span>
          <span class="absolute bottom-0 left-1/2 w-0 h-1 bg-[#d9b08c] transition-all group-hover:w-full group-hover:-translate-x-1/2"></span>
        </li>
        {% endfor %}
      </ul>
    </div>

    <!-- Products Grid -->
    <div class="md:w-3/4">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

        {% for product in products %}
        <div class="product-card bg-white/70 backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden transform transition-all duration-300 hover:scale-105 hover:shadow-2xl animate-fadeIn"
             data-category="{{ product.category.id }}">
          <img src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'images/default.png' %}{% endif %}"
               alt="{{ product.title }}" class="w-full h-48 object-cover">
          <div class="p-4 text-center">
            <h5 class="font-semibold text-lg text-[#3b2f2f] mb-1">{{ product.title }}</h5>
            <p class="text-[#b46f40] font-semibold mb-2">Tk {{ product.price }}</p>
            <a href="{% url 'product_detail' product.id %}"
               class="inline-block bg-[#d9b08c] text-[#3b2f2f] px-4 py-2 rounded-lg font-semibold hover:bg-[#b5835a] hover:text-white transition shadow-md">
              View Details
            </a>
          </div>
        </div>
        {% empty %}
        <p class="text-white text-lg col-span-full text-center">No products available.</p>
        {% endfor %}

      </div>
    </div>
  </div>

  <!-- Scroll to Top Button -->
  <button id="scrollTopBtn"
          class="hidden fixed bottom-6 right-6 bg-[#d9b08c] hover:bg-[#b5835a] text-white rounded-full w-12 h-12 shadow-lg flex items-center justify-center text-2xl transition-all duration-300">
    â†‘
  </button>
</div>

<!-- Category Filter -->
<script>
document.querySelectorAll('#category-list li').forEach(item => {
  item.addEventListener('click', function() {
    document.querySelectorAll('#category-list li').forEach(li => li.classList.remove('bg-[#d9b08c]', 'text-white'));
    this.classList.add('bg-[#d9b08c]', 'text-white');
    let selected = this.dataset.category;
    document.querySelectorAll('.product-card').forEach(card => {
      card.style.display = (selected === 'all' || card.dataset.category === selected) ? 'block' : 'none';
    });
  });
});

// Scroll-to-top button logic
const scrollTopBtn = document.getElementById('scrollTopBtn');
window.addEventListener('scroll', () => {
  scrollTopBtn.classList.toggle('hidden', window.scrollY < 300);
});
scrollTopBtn.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});
</script>

<!-- Fade Animation -->
<style>
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fadeIn {
  animation: fadeIn 0.6s ease-in-out both;
}
</style>

{% endblock %}
