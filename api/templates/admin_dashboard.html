{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard - NokshiBox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="bg-[#F5F0E6] font-sans relative">

<div class="flex min-h-screen">

    <!-- Sidebar -->
    <aside class="w-64 text-[#3b2f2f] flex flex-col "
           style="background-image: url('{% static 'image/ad.jpg' %}'); background-size: cover; background-position: center;">
        <!-- Logo -->
        <div class="p-6 flex flex-col items-center border-b border-[#b5835a]/40">
            <img src="{% static 'image/logo.png' %}" alt="Logo" class="w-25 h-25 object-cover">
            <a href="{% url 'home' %}" class="text-5xl font-family: 'Great Vibes' text-[#5a3e2b] hover:scale-105 transition-transform duration-300">
                Nokshi<span style="color: #a9745b;">Box</span>
            </a>
        </div>

        <!-- Nav Links -->
        <nav class="mt-6 flex-1">

            <a href="#products" class="block px-6 py-3 hover:text-[#a9745b] hover:bg-[#fff2d1]/30 transition font-medium text-lg">
                <i class="fa-solid fa-box-open mr-2"></i>Products
            </a>
            <a href="#categories" class="block px-6 py-3 hover:text-[#a9745b] hover:bg-[#fff2d1]/30 transition font-medium text-lg">
                <i class="fa-solid fa-list mr-2"></i>Categories
            </a>
            <a href="#users" class="block px-6 py-3 hover:text-[#a9745b] hover:bg-[#fff2d1]/30 transition font-medium text-lg">
                <i class="fa-solid fa-users mr-2"></i>Users
            </a>
        </nav>

        <!-- Logout -->
        <div class="p-6 border-t border-[#b5835a]/40">
            <a href="{% url 'admin_logout' %}" class="w-full text-center block bg-[#3b2f2f] text-white px-4 py-2 rounded-lg font-semibold hover:bg-[#5a3e2b] transition">
                <i class="fa-solid fa-right-from-bracket mr-2"></i>Logout
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 overflow-auto">
        <!-- Header -->
        <h1 id="home" class="text-3xl font-extrabold text-[#3b2f2f] mb-8">Admin Dashboard</h1>

        <!-- Dashboard Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="bg-[#F0EAD6]/90 p-6 rounded-2xl shadow border border-[#b5835a] text-center">
                <h3 class="text-xl font-bold text-[#3b2f2f]">Users</h3>
                <p class="text-[#4B3621] text-2xl mt-2">{{ users|length }}</p>
            </div>
            <div class="bg-[#F0EAD6]/90 p-6 rounded-2xl shadow border border-[#b5835a] text-center">
                <h3 class="text-xl font-bold text-[#3b2f2f]">Products</h3>
                <p class="text-[#4B3621] text-2xl mt-2">{{ products|length }}</p>
            </div>
            <div class="bg-[#F0EAD6]/90 p-6 rounded-2xl shadow border border-[#b5835a] text-center">
                <h3 class="text-xl font-bold text-[#3b2f2f]">Categories</h3>
                <p class="text-[#4B3621] text-2xl mt-2">{{ categories|length }}</p>
            </div>
        </div>

        <!-- Categories Section -->
        <section id="categories" class="mb-10">
            <h2 class="text-2xl font-bold text-[#3b2f2f] mb-4 border-b-2 border-[#b5835a] pb-2">Add Category</h2>
            <form method="post" class="bg-[#F0EAD6]/80 p-6 rounded-2xl shadow mb-6 border border-[#b5835a]">
                {% csrf_token %}
                <div class="mb-4">
                    {{ form.name.label_tag }}<br>
                    {{ form.name|add_class:"w-full p-2 border rounded" }}
                </div>
                <div class="mb-4">
                    {{ form.description.label_tag }}<br>
                    {{ form.description|add_class:"w-full p-2 border rounded" }}
                </div>
                <button type="submit" class="bg-[#3b2f2f] text-white px-4 py-2 rounded hover:bg-[#5a3e2b] transition">Add Category</button>
            </form>

            <!-- Categories List -->
            <h2 class="text-2xl font-bold text-[#3b2f2f] mb-4 border-b-2 border-[#b5835a] pb-2">Categories List</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {% for category in categories %}
                <div class="bg-[#F0EAD6]/90 p-4 rounded-2xl shadow border border-[#a9745b] hover:shadow-lg transition">
                    <h3 class="font-bold text-lg text-[#3b2f2f] mb-1">{{ category.name }}</h3>
                    <p class="text-[#4B3621] mb-2">{{ category.description }}</p>
                    <a href="{% url 'delete_entry' 'category' category.id %}" class="px-3 py-1 bg-[#3b2f2f] text-white rounded hover:bg-[#5a3e2b] transition" onclick="return confirm('Delete this category?')">Delete</a>
                </div>
                {% empty %}
                <p class="col-span-full text-[#3b2f2f]">No categories found.</p>
                {% endfor %}
            </div>
        </section>

        <!-- Users Section -->
        <section id="users" class="mb-10">
            <h2 class="text-2xl font-bold text-[#3b2f2f] mb-4 border-b-2 border-[#b5835a] pb-2">Users</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {% for user in users %}
                <div class="bg-[#F0EAD6]/90 p-4 rounded-2xl shadow border border-[#b5835a] hover:shadow-lg transition">
                    <h3 class="font-bold text-lg text-[#3b2f2f] mb-2">{{ user.email }}</h3>
                    <p class="text-[#4B3621]"><strong>Role:</strong> {{ user.role|title }}</p>
                    <div class="mt-4">
                        <a href="{% url 'delete_entry' 'user' user.id %}" class="px-3 py-1 bg-[#3b2f2f] text-white rounded hover:bg-[#5a3e2b] transition" onclick="return confirm('Delete this user?')">Delete</a>
                    </div>
                </div>
                {% empty %}
                <p class="col-span-full text-[#3b2f2f]">No users found.</p>
                {% endfor %}
            </div>
        </section>

        <!-- Products Section -->
        <section id="products" class="mb-10">
            <h2 class="text-2xl font-bold text-[#3b2f2f] mb-4 border-b-2 border-[#b5835a] pb-2">Products</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {% for product in products %}
                <div class="bg-[#F0EAD6]/90 p-4 rounded-2xl shadow border border-[#b5835a] hover:shadow-lg transition">
                    <h3 class="font-bold text-lg text-[#3b2f2f] mb-1">{{ product.title }}</h3>
                    <p class="text-[#4B3621]"><strong>Seller:</strong> {{ product.seller.email }}</p>
                    <p class="text-[#4B3621]"><strong>Category:</strong> {{ product.category.name }}</p>
                    <div class="mt-4">
                        <a href="{% url 'delete_entry' 'product' product.id %}" class="px-3 py-1 bg-[#3b2f2f] text-white rounded hover:bg-[#5a3e2b] transition" onclick="return confirm('Delete this product?')">Delete</a>
                    </div>
                </div>
                {% empty %}
                <p class="col-span-full text-[#3b2f2f]">No products found.</p>
                {% endfor %}
            </div>
        </section>

    </main>
</div>

<!-- Scroll to Top Button -->
<button id="scrollTopBtn"
        class="fixed bottom-6 right-6 bg-[#3b2f2f] text-white p-3 rounded-full shadow-lg hover:bg-[#5a3e2b] transition hidden">
    <i class="fa-solid fa-arrow-up"></i>
</button>

<script>
    const scrollBtn = document.getElementById('scrollTopBtn');

    // Show button when user scrolls down
    window.onscroll = function() {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            scrollBtn.classList.remove('hidden');
        } else {
            scrollBtn.classList.add('hidden');
        }
    };

    // Scroll to top smoothly on click
    scrollBtn.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });
</script>

</body>
</html>
