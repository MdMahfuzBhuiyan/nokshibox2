{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ user_profile.full_name }} - Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body {
      background-image: url("{% static 'image/pro.png' %}");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    .floating {
      position: absolute;
      border-radius: 50%;
      opacity: 0.15;
      animation: float 20s linear infinite;
    }

    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-50px) rotate(180deg); }
      100% { transform: translateY(0) rotate(360deg); }
    }

    .hover-up:hover {
      transform: translateY(-5px);
      transition: transform 0.3s ease;
    }

    /* Scroll to Top Button */
    #scrollTop {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #a9745b;
      color: white;
      border: none;
      padding: 10px 14px;
      border-radius: 50%;
      font-size: 18px;
      cursor: pointer;
      display: none;
      transition: all 0.3s ease;
    }

    #scrollTop:hover {
      background-color: #8b5e3b;
    }
  </style>
</head>
<body class="relative min-h-screen text-[#3b2f2f]">

<!-- Profile Completion Alert -->
{% if request.user.is_authenticated and not request.user.profile_completed %}
<div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 text-center">
   ⚠️ Please <a href="{% url 'edit_profile' request.user.pk %}" class="font-bold underline">complete your profile</a> to secure your account.
</div>
{% endif %}

<!-- Navbar -->
<nav class="bg-[#f5f0e6]/90 backdrop-blur-md shadow-md sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

    <a href="#" class="text-5xl hover:scale-105 transition-transform duration-300"
       style="font-family: 'Great Vibes', cursive; color: #5a3e2b; -webkit-text-stroke: 0.6px #5a3e2b;">
      Nokshi<span style="color: #a9745b;">Box</span>
    </a>

    <ul class="flex space-x-6">
      <li><a href="/" class="text-black hover:text-[#a9745b] font-medium">Home</a></li>
      <li><a href="{% url 'seller_home' %}" class="text-black hover:text-[#a9745b] font-medium">Dashboard</a></li>
      <li><a href="{% url 'logout' %}" class="text-black hover:text-[#a9745b] font-medium">Logout</a></li>
    </ul>
  </div>
</nav>

<!-- Floating Decorations -->
<div class="floating w-32 h-32 bg-[#d9b08c] top-10 left-20"></div>
<div class="floating w-20 h-20 bg-[#c49a6c] top-1/2 left-1/4"></div>
<div class="floating w-24 h-24 bg-[#b5835a] top-3/4 left-3/4"></div>

<!-- Main Section -->
<div class="relative max-w-7xl mx-auto px-6 py-16">
  <div class="flex flex-col md:flex-row gap-10 items-start">

    <!-- Profile Card -->
    <div class="w-full md:w-1/3 bg-[#F0EAD6]/60 rounded-2xl shadow-3xl border border-[#c49a6c]/50 p-6 hover-up">
      <div class="flex flex-col items-center text-center">
        {% if user_profile.photo %}
          <img src="{{ user_profile.photo.url }}" alt="{{ user_profile.full_name }}"
               class="w-42 h-42 rounded-full border-4 border-[#a9745b] object-cover mb-4 shadow-md">
        {% else %}
          <div class="w-28 h-28 rounded-full bg-[#a9745b] flex items-center justify-center text-[#fff2d1] text-3xl font-bold mb-4">
            {{ user_profile.full_name|slice:":1" }}
          </div>
        {% endif %}

        <h2 class="text-2xl font-extrabold text-[#3b2f2f]">{{ user_profile.full_name }}</h2>

        <div class="mt-3 space-y-1 text-[#4B3621]">
          <p><i class="fa-solid fa-envelope mr-2"></i>{{ user_profile.email }}</p>
          <p><i class="fa-solid fa-phone mr-2"></i>{{ user_profile.mobile_no }}</p>
          {% if user_profile.facebook_link %}
            <a href="{{ user_profile.facebook_link }}" target="_blank" class="hover:text-[#a9745b]">
              <i class="fab fa-facebook mr-2"></i>Facebook Page
            </a>
          {% endif %}
        </div>

        {% if is_owner %}
        <a href="{% url 'edit_profile' user_profile.pk %}"
           class="mt-5 inline-block bg-gradient-to-r from-[#c49a6c] to-[#b5835a] text-[#3b2f2f] px-5 py-2 rounded-lg font-semibold hover:from-[#b5835a] hover:to-[#a9745b] transition duration-300 shadow-md">
          Edit Profile
        </a>
        {% endif %}
      </div>

      <div class="mt-6 border-t border-[#b5835a]/40 pt-4 text-[#4B3621]">
        <p><strong>Products:</strong> {{ products|length }}</p>
        <p><strong>Role:</strong> Seller</p>
      </div>
    </div>

    <!-- Products Section -->
    <div class="w-full md:w-2/3">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-extrabold text-[#3b2f2f] border-b-2 border-[#b5835a] pb-2">
          My Products
        </h2>
        <input type="text" id="searchInput" placeholder="Search products..."
               class="border  border-[#b5835a]/90 rounded-lg px-5 py-2 focus:ring-2 focus:ring-[#b5835a] outline-none">
      </div>

      {% if products %}
      <div id="productGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for product in products %}
        <div class="product-card bg-[#F0EAD6]/90 rounded-xl shadow-lg hover:scale-[1.03] transition transform hover-up border border-[#a9745b]/50 overflow-hidden">
          <img src="{{ product.image.url }}" alt="{{ product.title }}" class="w-full h-48 object-cover">
          <div class="p-4">
            <h3 class="text-lg font-bold text-[#3b2f2f] mb-1 truncate">{{ product.title }}</h3>
            <p class="text-[#4B3621] text-sm mb-2 truncate">{{ product.details|truncatechars:70 }}</p>
            <p class="text-[#3b2f2f] font-semibold mb-3">TK {{ product.price }}</p>
            <a href="{% url 'product_detail' product.pk %}"
               class="block text-center bg-[#b5835a] text-[#3b2f2f] py-2 rounded-lg font-semibold hover:bg-[#a9745b] transition">
               View Details
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <p class="text-center text-[#4B3621] mt-8">You haven't added any products yet.</p>
      {% endif %}
    </div>
  </div>
</div>

<!-- Scroll to Top Button -->
<button id="scrollTop"><i class="fa-solid fa-arrow-up"></i></button>

<!-- Footer -->
<footer class="bg-[#f5f0e6]/95 text-center text-[#3b2f2f] border-t border-[#b5835a]/50 py-4 mt-10">
  <p>© 2025 <span class="font-semibold text-[#a9745b]">NokshiBox</span> — Crafted with love for local artisans ✨</p>
</footer>

<!-- JS -->
<script>
  // Search filter
  const searchInput = document.getElementById('searchInput');
  const productCards = document.querySelectorAll('.product-card');

  searchInput.addEventListener('keyup', function() {
    const query = this.value.toLowerCase();
    productCards.forEach(card => {
      const title = card.querySelector('h3').textContent.toLowerCase();
      card.style.display = title.includes(query) ? 'block' : 'none';
    });
  });

  // Scroll to top
  const scrollBtn = document.getElementById('scrollTop');
  window.onscroll = function() {
    if (document.documentElement.scrollTop > 300) {
      scrollBtn.style.display = 'block';
    } else {
      scrollBtn.style.display = 'none';
    }
  };
  scrollBtn.onclick = function() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };
</script>

</body>
</html>
